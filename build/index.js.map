{"version":3,"sources":["../index.js"],"names":["msg_types","Sphinx","MSG_TYPE","initted","token","process","env","TOKEN","sphinxToken","SPHINX_TOKEN","url","init","client","Client","login","on","INSTALL","message","embed","MessageEmbed","setAuthor","setDescription","setThumbnail","botSVG","channel","send","MESSAGE","arr","content","split","length","cmd","console","log","isAdmin","member","roles","find","role","name","fetch","headers","r","ok","json","j","price","data","BTC","quote","USD","toFixed","percentChange24","percent_change_24h","percentChange24String","changeColor","setTitle","addFields","value","inline","color","sats","Math","round"],"mappings":"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","sourcesContent":["import 'regenerator-runtime/runtime.js';\nimport * as Sphinx from 'sphinx-bot'\nimport * as fetch from 'node-fetch'\nconst msg_types = Sphinx.MSG_TYPE\n\nlet initted = false\n\n/*\n// SPHINX_TOKEN contains id,secret,and url\n// message.channel.send sends to the url the data\n*/\n\nconst token = process.env.TOKEN\nconst sphinxToken = process.env.SPHINX_TOKEN\nconst url = 'https://pro-api.coinmarketcap.com/v1/cryptocurrency/quotes/latest'\n\nfunction init() {\n  if (initted) return\n  initted = true\n\n  const client = new Sphinx.Client()\n  client.login(sphinxToken)\n\n  client.on(msg_types.INSTALL, async (message) => {\n    const embed = new Sphinx.MessageEmbed()\n      .setAuthor('BitcoinBot')\n      .setDescription('Welcome to Bitcoin Bot!')\n      .setThumbnail(botSVG)\n    message.channel.send({ embed })\n  })\n\n  client.on(msg_types.MESSAGE, async (message) => {\n    const arr = message.content.split(' ')\n    if (arr.length < 2) return\n    if (arr[0] !== '/btc') return\n    const cmd = arr[1]\n\n    switch (cmd) {\n\n      case 'price':\n        console.log(\"price\")\n        const isAdmin = message.member.roles.find(role => role.name === 'Admin')\n        console.log('=> IS ADMIN?', isAdmin)\n        try {\n          const r = await fetch(url + '?symbol=BTC&convert=USD', {\n            headers: { 'X-CMC_PRO_API_KEY': token, 'Accept': 'application/json' }\n          })\n          if (!r.ok) return\n          const j = await r.json()\n          const price = '$' + j.data.BTC.quote.USD.price.toFixed(2)\n          const percentChange24 = j.data.BTC.quote.USD.percent_change_24h\n          const percentChange24String = percentChange24.toFixed(2) + '%'\n          const changeColor = percentChange24 > 0 ? '#00c991' : '#e74744'\n          const embed = new Sphinx.MessageEmbed()\n            .setAuthor('BitcoinBot')\n            .setTitle('Bitcoin Price:')\n            .addFields([\n              { name: 'Price:', value: price, inline: true },\n              { name: '24 Hour Change:', value: percentChange24String, inline: true, color: changeColor }\n            ])\n            .setThumbnail(botSVG)\n          message.channel.send({ embed })\n        } catch (e) {\n          console.log('BTC bot error', e)\n        }\n        return\n\n      case 'sats':\n        console.log(\"price\")\n        try {\n          const r = await fetch(url + '?symbol=BTC&convert=USD', {\n            headers: { 'X-CMC_PRO_API_KEY': token, 'Accept': 'application/json' }\n          })\n          if (!r.ok) return\n          const j = await r.json()\n          const price = j.data.BTC.quote.USD.price / 100000000\n          const sats = Math.round(1/price) + ''\n          const embed = new Sphinx.MessageEmbed()\n            .setAuthor('BitcoinBot')\n            .setTitle('Sats:')\n            .addFields([\n              { name: 'Sats per dollar:', value: sats, inline: true },\n            ])\n            .setThumbnail(botSVG)\n          message.channel.send({ embed })\n        } catch (e) {\n          console.log('BTC bot error', e)\n        }\n        return\n\n      default:\n        const embed = new Sphinx.MessageEmbed()\n          .setAuthor('BitcoinBot')\n          .setTitle('BitcoinBot Commands:')\n          .addFields([\n            { name: 'Print BTC price', value: '/btc price' },\n            { name: 'Help', value: '/btc help' }\n          ])\n          .setThumbnail(botSVG)\n        message.channel.send({ embed })\n        return\n    }\n  })\n}\n\nconst botSVG = `<svg viewBox=\"64 64 896 896\" height=\"12\" width=\"12\" fill=\"white\">\n  <path d=\"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z\" />\n</svg>`\n\ninit()"],"file":"index.js"}